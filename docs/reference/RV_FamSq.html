<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Rare Variant-Family-Based Score Test for Quantitative Traits — RV_FamSq • RVFamSq</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Rare Variant-Family-Based Score Test for Quantitative Traits — RV_FamSq" />
<meta property="og:description" content="A regional association analysis of rare variants and quantitative traits in
family data
RV_FamSq &amp;lt;- function(ped_pheno, ped_geno, maf_data, maf_cutoff,parafile,covar_col, trait_col, pop_col=c(), out,kin, estimateAF,start_par)" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RVFamSq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statgenetics/RVFamSq">Source</a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rare Variant-Family-Based Score Test for Quantitative Traits</h1>
    <small class="dont-index">Source: <a href='https://github.com/statgenetics/RVFamSq/blob/master/R/RVFamSq.R'><code>R/RVFamSq.R</code></a></small>
    <div class="hidden name"><code>RV_FamSq.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A regional association analysis of rare variants and quantitative traits in
family data
RV_FamSq &lt;- function(ped_pheno, ped_geno, maf_data, maf_cutoff,parafile,covar_col, trait_col, pop_col=c(), out,kin, estimateAF,start_par)</p>
    </div>

    <pre class="usage"><span class='fu'>RV_FamSq</span>(<span class='no'>ped_pheno</span>, <span class='no'>ped_geno</span>, <span class='no'>maf_data</span>, <span class='no'>maf_cutoff</span>, <span class='no'>parafile</span>, <span class='no'>covar_col</span>,
  <span class='no'>trait_col</span>, <span class='kw'>pop_col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(), <span class='no'>out</span>, <span class='no'>kin</span>, <span class='no'>estimateAF</span>, <span class='no'>start_par</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ped_pheno</th>
      <td><p>a dataframe of phenotype. The first four columns should be family IDs, 
individual IDs, father IDs and mother IDs of each sample.
The ped_pheno can also include columns of covariates and populations IDs. 
If more than one population groups are included in the analysis, the column of population IDs should indicate which population specific MAF will be used.</p></td>
    </tr>
    <tr>
      <th>ped_geno</th>
      <td><p>a dataframe of genotype. The first two columns are family IDs and individual IDs. 
The rest columns of the ped_geno are genotype score at each sites. The value of genotype score is 0, 1 or 2,
corresponding to number of rare variants observed at each sites. Number of sites included in ped_geno should be equal to the number of rows 
of <code>maf_data</code>.</p></td>
    </tr>
    <tr>
      <th>maf_data</th>
      <td><p>a dataframe describing the information of rare variants included in ped_geno.
The first three columns correspond to the name of the gene, chromosome number, and position of variants. The rest columns of maf_data
are MAFs of variants in each specific population group obtained from database, e.g., Genome Aggregation Database (gnomAD).</p></td>
    </tr>
    <tr>
      <th>maf_cutoff</th>
      <td><p>the cutoff of MAF for rare variants</p></td>
    </tr>
    <tr>
      <th>parafile</th>
      <td><p>the path to the file saving parameters estimated under the null model.
If the file is not existed, the package will estimate the parameters
using the available data and create a parafile in the path. Otherwise, the package will utilize the parameters in <code>parafile</code> to calculate the statistical score.</p></td>
    </tr>
    <tr>
      <th>covar_col</th>
      <td><p>a integer or a vector of integers indicating which columns of <code>ped_pheno</code> will be used as covariants of the analysis. Note that 
multiple covariants are allowed in the analysis.</p></td>
    </tr>
    <tr>
      <th>trait_col</th>
      <td><p>a integer indicating which columns of <code>ped_pheno</code> will be used as traits.</p></td>
    </tr>
    <tr>
      <th>pop_col</th>
      <td><p>a integer indicating which columns of <code>ped_pheno</code> represent the population IDs of the sample.</p></td>
    </tr>
    <tr>
      <th>out</th>
      <td><p>the directory that save the results. RVFamSq outputs a dataframe results including
the name of the gene, score, p-value of the gene, number of sample size
and number of families</p></td>
    </tr>
    <tr>
      <th>kin</th>
      <td><p>a kinship matrix calculated either based on family strtuctures or genomic informations.</p></td>
    </tr>
    <tr>
      <th>estimateAF</th>
      <td><p>a dataframe of estimated MAFs that do not oberserved in public datasets. The headers decribing the name 
of the sub-population should be consistent with the headers in <code>maf_data</code>. If this argument is not defined, RVfamSq will
estimate the missing MAF based on the dosage of founder.</p></td>
    </tr>
    <tr>
      <th>start_par</th>
      <td><p>an optional argument that defines the starting values of
the parameters fitting. User can define specific values to start the
parameters fitting, otherwise, the starting values will generate randomly.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>results</dt><dd><p>a data frame results containing the name of the gene,
the value of the score and p-value write into the file named by the name of
the gene under the directory defined by the argument <code>out</code>.</p></dd>
<dt>paras</dt><dd><p>a list of parameters estimated by maximizing the likelihood.
The values of the paras save to the file defined by the argument
<code>parafile</code>. If the <code>parafile</code> is existed, the values of the paras
load from the file <code>parafile</code>.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>RVFamSq performed association analysis by estimating the parameters under the null model and calculating the statistical score using these parameters.
The parameters are estimated by maximizing the multivariate normal likelihood: 
$$L=\prod_{i}(2\pi)^{-n_i / 2}\left |\Omega _i\right |^{-1 /2}e^{\left [ y_i - E(y_i)\right ]'\Omega _i^{-1}\left [ y_i - E(y_i)\right ]}$$ 
where \(n_i\) is the number of individuals in family i and \(\left |\Omega _i\right |\) is the determinant of matrix \(\Omega _i\). \(E(y_i)\) in the above
function is a vector of expected phenotype of all individuals within each family and is calculated by: 
$$E(y_i)=\mu + \beta _x x_i$$
where \(x_i\) is a \(n_i \times q\) matrix of q covariates included in the association analysis. The parameters \(\mu\) and \(\beta _x\) are population mean and a vector of covariate effects. 
The two parameters are estimated by maximizing the above likelihood function. The matrix \(\Omega_i\) in the likelihood function is calculated within each family i and defined as:
$$\Omega  _{ijk}\left\{\begin{matrix}\sigma _g^2 + \sigma_e^2\ \ \ \ \ \ \ \ \ \ \ \ \ if\  j=k\\
2\varphi _{ijk}\sigma _g^2\ \ \ \ \ \ \ \ \ \ \ \ if\ i\neq k 
\end{matrix}\right.$$
Here, the parameter \(\sigma_g^2\) and\(\sigma_e^2\) are variance components that are account for background polygenic effects
and environmental effects, respectively. Additionally, \(\Omega _{ijk}\) denote the kinship coefficient between individuals j and k. 
The values of parameters \(\sigma_g^2\), \(\sigma_e^2\), \(\beta_x\), and \(\mu\) are estimated by maximizing the above likelihood.
With the values of these parameters, we can obtain the variance-covariance matrix  \(\Omega _i^{base}\) and vector \(E(y_i)^{base}\) based on the above equations for each family. 
Using these two quantities, the statistic score is defined by:
$$T^{SCORE}=\frac{\left \{ \sum _i \left [G_i -E(G_i)\right ]'[\Omega _i^{(base)}]^{-1}[y_i-E(y_i)^{(base)}] \right \}^2}{\sum _i[G_i-E(G_i)]'[\Omega_i^{(base)}]^{-1}[G_i-E(G_i)^{(base)}] }$$
where \(E(G_i)\) is defined as:
$$E(G_i)=\sum_{m=1}^{M}2p_m$$
where \(p_m\) is the minor allele frequency (MAF) which is obtain from the dataframe of <code>maf_data</code>.</p>
    <h2 class="hasAnchor" id="data-format"><a class="anchor" href="#data-format"></a>Data format</h2>

    

<p>Example data is generated for 1,000 extended families with 10 members in each family. The information of RVs within functional region of the gene AAAS with MAF&lt;2<!-- % are obtained from gnomeAD.  -->
Quantitative traits are generated randomly based on the disribution of N(0,1) and genotypes of samples are generated based on MAF of the gene AAAS.</p><ul>
<li><p><strong>ped_pheno.txt</strong> A phenotype file of 1,000 extended families (10,000 individuals in total). Each column of the file represents family IDs, individual IDs, father IDs, mother IDs, sex, traits, and population IDs, respectively. 
RVFamSq is capable to analyze multiple covariates and extra covariants should be also included in this file after the fourth column.</p></li>
<li><p><strong>ped_geno.txt</strong> A genotype file of samples included in the ped_pheno.txt file. The first two columns of the file should be family IDs and individual IDs that have the same format as in ped_pheno.txt. 
The rest columns of the file are genotypes of each individual and codes as 0, 1, and 2.</p></li>
<li><p><strong>AAAS.sfs</strong> A file with descriptive information of RVs within the functional region of the gene AAAS. The file contains four columns representing the name of the interested gene, chromosome, position, and MAF of the variant, respectively.
If more than one sub-populations are included in the samples, multiple MAFs correspond to each specific population should be included in this file and denoted by headers of population specific symbols</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chen, W.-M., and Abecasis, G.R. (2007). Family-Based Association
Tests for Genomewide Association Scans. Am. J. Hum. Genet. 81, 913–926.<br /></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span> (<span class='no'>kinship2</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: quadprog</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span> (<span class='no'>RVFamSq</span>)

<span class='co'>##  load example data</span>
<span class='no'>data_dir</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"RVFamSq"</span>)
<span class='no'>ped_pheno</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></span>(<span class='no'>phenofile</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='no'>data_dir</span>,<span class='st'>"/ped_pheno.txt"</span>))
<span class='no'>ped_geno</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='no'>data_dir</span>, <span class='st'>"/ped_geno.txt"</span>))
<span class='no'>maf_data</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='no'>data_dir</span>,<span class='st'>"/AAAS.sfs"</span>), <span class='kw'>header</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>## Define the files that save the parameters estimated under the null model.</span>
<span class='co'>## If the file is not existed, the package will estimate the parameters based on the available data.</span>
<span class='no'>parafile</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='no'>data_dir</span>,<span class='st'>"/paras.rds"</span>)

<span class='co'>##  Define output directory that save the results</span>
<span class='no'>out</span><span class='kw'>&lt;-</span><span class='st'>"results"</span>

<span class='co'>## Load phenotype data and calculate the kinship matrix of the pedigree. In this example, we utilize the R package to estimate the kinship of samples based on family structure, but the kinship can also be estimated by genetic variants.</span>
<span class='no'>kin_pre</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>id</span><span class='kw'>=</span><span class='no'>ped_pheno</span>[,<span class='fl'>2</span>], <span class='kw'>mom</span><span class='kw'>=</span><span class='no'>ped_pheno</span>[,<span class='fl'>4</span>], <span class='kw'>dad</span><span class='kw'>=</span><span class='no'>ped_pheno</span>[,<span class='fl'>3</span>], <span class='kw'>sex</span><span class='kw'>=</span><span class='no'>ped_pheno</span>[,<span class='fl'>5</span>])
<span class='no'>tped</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>kin_pre</span>, <span class='fu'><a href='https://rdrr.io/pkg/kinship2/man/pedigree.html'>pedigree</a></span>(<span class='no'>id</span>, <span class='no'>dad</span>, <span class='no'>mom</span>, <span class='no'>sex</span>, <span class='kw'>famid</span><span class='kw'>=</span><span class='no'>ped_pheno</span>[,<span class='fl'>1</span>]))
<span class='no'>kin</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/kinship2/man/kinship.html'>kinship</a></span>(<span class='no'>tped</span>)

<span class='co'>## Run RVFamsSq package and calculate the statistical score of the interested gene. If \code{parafile} is not existed, the below command will estimate the parameters using the available data.</span>
<span class='co'>## Once you obtained the values of parameters, you can </span>
<span class='co'>## Results can be found under `results/` folder.</span>
<span class='fu'>RV_FamSq</span>(<span class='kw'>ped_pheno</span><span class='kw'>=</span><span class='no'>ped_pheno</span>, <span class='kw'>ped_geno</span><span class='kw'>=</span><span class='no'>ped_geno</span>, <span class='kw'>maf_data</span><span class='kw'>=</span><span class='no'>maf_data</span>, <span class='kw'>maf_cutoff</span> <span class='kw'>=</span><span class='fl'>0.02</span>, <span class='kw'>parafile</span><span class='kw'>=</span><span class='no'>parafile</span>, <span class='kw'>covar_col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>), <span class='kw'>trait_col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>6</span>), <span class='kw'>pop_col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>7</span>), <span class='kw'>out</span><span class='kw'>=</span><span class='no'>out</span>, <span class='kw'>kin</span><span class='kw'>=</span><span class='no'>kin</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: stats4</span></div><div class='output co'>#&gt; [1] "Reading parameters from parafile... "
#&gt;          miu        betax        sitag        sitae 
#&gt; -0.022380967  0.017890922 -0.002580334 -0.990842121 </div><div class='output co'>#&gt; <span class='warning'>Warning: cannot open file 'results/AAAS.out': No such file or directory</span></div><div class='output co'>#&gt; <span class='error'>Error in file(file, ifelse(append, "a", "w")): cannot open the connection</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#data-format">Data format</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Zhihui Zhang and Suzanne Leal</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zhihui Zhang, Suzanne Leal.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


