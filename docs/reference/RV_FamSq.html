<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Rare Variant-Family-Based Score Test for Quantitative Traits — RV_FamSq • RVFamSq</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Rare Variant-Family-Based Score Test for Quantitative Traits — RV_FamSq" />

<meta property="og:description" content="A regional association analysis of rare variants and quantitative traits in
family data" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RVFamSq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statgenetics/RVFamSq">Source</a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rare Variant-Family-Based Score Test for Quantitative Traits</h1>
    <small class="dont-index">Source: <a href='https://github.com/statgenetics/RVFamSq/blob/master/R/RVFamSq.R'><code>R/RVFamSq.R</code></a></small>
    <div class="hidden name"><code>RV_FamSq.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>A regional association analysis of rare variants and quantitative traits in
family data</p>
    
    </div>

    <pre class="usage"><span class='fu'>RV_FamSq</span>(<span class='no'>genofile</span>, <span class='no'>phenofile</span>, <span class='no'>maffile</span>, <span class='no'>parafile</span>, <span class='no'>covar_col</span>, <span class='no'>trait_col</span>, <span class='no'>out</span>,
  <span class='no'>kin</span>, <span class='kw'>start_par</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>genofile</th>
      <td><p>referring to the path of the genotype file. The columns in
the file represent family IDs, individual IDs and genotypes of each
individual. The file should not have header.</p></td>
    </tr>
    <tr>
      <th>phenofile</th>
      <td><p>referring to the path of the phenotype file. The first five
columns in the file should be family IDs,individual IDs, father IDs, mother
IDs, and sex, respectively. The rest columns of the file are covariates and
trait. The covariates may be multi-columns and trait should be one column.
The file should not have header.</p></td>
    </tr>
    <tr>
      <th>maffile</th>
      <td><p>the path to the .sfs file describing the information of
variants in the genotype file.</p></td>
    </tr>
    <tr>
      <th>parafile</th>
      <td><p>the path to the file saving parameters estimated in null
model. If the file is not existed, the package will estimate the parameters
using the available data and save the values of the parameters in parafile.</p></td>
    </tr>
    <tr>
      <th>covar_col</th>
      <td><p>a vector defining the index of columns of covariates in
<code>phenofile</code>.</p></td>
    </tr>
    <tr>
      <th>trait_col</th>
      <td><p>an integer number defining the column of interested trait
in <code>phenofile</code>.</p></td>
    </tr>
    <tr>
      <th>out</th>
      <td><p>the directory that save the results. RVFamSq produces output file
with the name of the gene, score, p-value of the gene, number of sample size
and number of families</p></td>
    </tr>
    <tr>
      <th>kin</th>
      <td><p>a kinship matrix calculated from the pedigree using the
“kinship2” package</p></td>
    </tr>
    <tr>
      <th>start-par</th>
      <td><p>an optional argument that defines the starting values of
the parameters fitting. User can define specific values to start the
parameters fitting, otherwise, the starting values will generate randomly.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>results</dt><dd><p>a data frame results containing the name of the gene,
the value of the score and p-value write into the file named by the name of
the gene under the directory defined by the argument <code>out</code>.</p></dd>
<dt>paras</dt><dd><p>a list of parameters estimated by maximizing the likelihood.
The values of the paras save to the file defined by the argument
<code>parafile</code>”. If the <code>parafile</code> is existed, the values of the paras
load from the file <code>parafile</code>.</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>RVFamSq estimates the parameter under the null model by Association can be tested by maximizing the multivariate normal likelihood:
$$\beta \cdots X_1 whatever$$ (add formula here using LaTeX syntax)</p>
    
    <h2 class="hasAnchor" id="data-format"><a class="anchor" href="#data-format"></a>Data format</h2>

    
    <p>Test data is generated for 100 nuclear families with sib-pairs and 100 sites of variants for each individual. The quantitative traits and MAF of variants are sampled randomly. The genotype of these samples are generated according to the MAF of each variant.</p><ul>
<li><p><strong>test.pheno</strong> A phenotype file of 100 nuclear families and 100 sites of variants for each individual. The first five columns of the file should be family IDs, individual IDs, father IDs, mother IDs, sex, respectively. The interested covariates and trait for each sample could be listed in the rest columns of the file. RVFamSq is capable to analyze multiple covariates. Each family should have information of two founders, and all individuals in test.geno should be included in this file.</p></li>
<li><p><strong>test.geno</strong> A genotype file of samples included in the test.pheno file. The first two columns of the file should be family IDs and individual IDs that have the same format as in test.pheno. The rest columns of the file are genotypes of each individual and codes as 0, 1, and 2.</p></li>
<li><p><strong>test.sfs</strong> A file with descriptive information for 100 genetic variants in test.geno. The file contains four columns representing the name of the interested gene, chromosome, position, and MAF of the variant, respectively.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chen, W.-M., and Abecasis, G.R. (2007). Family-Based Association
Tests for Genomewide Association Scans. Am. J. Hum. Genet. 81, 913–926.<br /></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span> (<span class='no'>kinship2</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: quadprog</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span> (<span class='no'>RVFamSq</span>)

<span class='co'>##  Define variables pointing to the path to the example data</span>
<span class='no'>data_dir</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"data"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"RVFamSq"</span>)
<span class='no'>maffile</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='no'>data_dir</span>,<span class='st'>"/test.sfs"</span>)
<span class='no'>genofile</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='no'>data_dir</span>, <span class='st'>"test.geno"</span>)
<span class='no'>phenofile</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='no'>data_dir</span>,<span class='st'>"/test.pheno"</span>)

<span class='co'>##  Define output directory that save the results</span>
<span class='no'>out</span><span class='kw'>&lt;-</span><span class='st'>"/directory-to-save-the-results"</span>

<span class='co'>## Define the files that save the parameters estimated under the null model.</span>
<span class='co'>## If the file is not existed, the package will estimate the parameters based on the available data.</span>
<span class='no'>parafile</span><span class='kw'>&lt;-</span><span class='st'>"/ directory-to-example-data /paras.rds"</span>

<span class='co'>## Load phenotype data and calculate the kinship matrix of the pedigree.</span>
<span class='no'>ped_pheno</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/read.table'>read.table</a></span>(<span class='no'>phenofile</span>)
<span class='no'>kin_pre</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='kw'>id</span><span class='kw'>=</span><span class='no'>ped_pheno</span>[,<span class='fl'>2</span>], <span class='kw'>mom</span><span class='kw'>=</span><span class='no'>ped_pheno</span>[,<span class='fl'>4</span>], <span class='kw'>dad</span><span class='kw'>=</span><span class='no'>ped_pheno</span>[,<span class='fl'>3</span>], <span class='kw'>sex</span><span class='kw'>=</span><span class='no'>ped_pheno</span>[,<span class='fl'>5</span>])
<span class='no'>tped</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/with'>with</a></span>(<span class='no'>kin_pre</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/kinship2/topics/pedigree'>pedigree</a></span>(<span class='no'>id</span>, <span class='no'>dad</span>, <span class='no'>mom</span>, <span class='no'>sex</span>, <span class='kw'>famid</span><span class='kw'>=</span><span class='no'>ped_pheno</span>[,<span class='fl'>1</span>]))
<span class='no'>kin</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/kinship2/topics/kinship'>kinship</a></span>(<span class='no'>tped</span>)

<span class='co'>## Run RVFamsSq package and calculate the statistical score of the interested gene.</span>
<span class='fu'>RV_FamSq</span>(<span class='no'>pedfile</span>, <span class='no'>phenofile</span>, <span class='no'>maffile</span>, <span class='no'>parafile</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>7</span>), <span class='fl'>6</span>, <span class='no'>out</span>,<span class='no'>kin</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: stats4</span></div><div class='output co'>#&gt; <span class='error'>Error in file.exists(genofile): object 'pedfile' not found</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#data-format">Data format</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Zhihui Zhang and Suzanne Leal</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Zhihui Zhang, Suzanne Leal.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

